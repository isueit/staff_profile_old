<?php
use \Drupal\Core\Field\FieldDefinitionInterface;
use \Drupal\Core\Session\AccountInterface;
use \Drupal\Core\Field\FieldItemListInterface;
use Drupal\Core\Access\AccessResult;

/**
 * @file
 * Staff Profile module
 */

 /**
  * Implements hook_entity_field_access()
  */
 function staff_profile_entity_field_access($operation, $field_defintition, $account, $items = NULL) {
   $admin_options = array('weight', 'status', 'user_id', 'field_from_staff_directory', 'field_department_id');
   if ($field_defintition->getTargetEntityTypeId() == 'staff_profile_profile' && in_array($field_defintition->getName(), $admin_options) && $operation == 'edit') {
     if ($account->hasPermission('administer staff profile entity')) {
       return AccessResult::allowedIfHasPermission($account, 'administer staff profile entity');
     } else {
       return AccessResult::forbidden();
     }
   }
   return AccessResult::neutral();
 }

 /**
  * Implements hook_Entity_Type_view_alter()
  * Uses label (name) as title, page meta title remains the same
  */
function staff_profile_staff_profile_profile_view_alter(array &$build, Drupal\Core\Entity\EntityInterface $entity, \Drupal\Core\Entity\Display\EntityViewDisplayInterface $display) {
  $build['#title'] = $entity->label();
}
